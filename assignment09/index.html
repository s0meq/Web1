<!DOCTYPE html>
<html lang="fi">
<head>
  <meta charset="UTF-8">
  <title>Pok√©mon-taulukko jQueryll√§</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f5f5f5; }
    button { background: #007bff; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; }
    button:hover { background: #0056b3; }
    table { border-collapse: collapse; margin-top: 20px; background: white; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 8px; }
    th { background: #eee; text-align: left; cursor: pointer; }
  </style>
</head>
<body>

  <h1>Pok√©mon-lista</h1>
  <p>T√§ss√§ teht√§v√§ss√§ haetaan julkisesta REST API:sta JSON-dataa ja n√§ytet√§√§n se taulukkona.</p>

  <button id="load-data">Lataa Pok√©monit</button>

  <div id="result"></div>

  <script>

    $(document).ready(function() {
      $("#load-data").on("click", function() {
        $("#result").empty();
        $("#result").html("<p>Ladataan dataa...</p>");
        let pokemonData = null;
        $.get("https://pokeapi.co/api/v2/pokemon?limit=10", function(data) {
          pokemonData = data.results;
          setTimeout(() => {
            $("#result").empty();
            printTable(pokemonData);
            updateList(pokemonData);
          }, 600);
        }); // .get
      }); // on click
    }); // Document ready

    function printTable(pokemonData) {
      $("#result").html('<table id="pokemonTable"></table>');
      $("#pokemonTable").html('<tr id="headerRow"></tr>');
      $("#headerRow").append(
        $('<th id="headerName"></th>').text("Nimi ‚¨ç"), 
        $('<th></th>').text("API - Linkki")
      );
      let ascending = true;
      $("#headerName").on("click", () => {
        sortPokemonsByName(pokemonData, ascending);
        ascending = !ascending;
      });
    }

    // Sort by name when "name" header cell is clicked
    function sortPokemonsByName(pokemonData, ascending) {
      let sortedPokemonData = pokemonData.sort(function(a, b) {
        return a.name.localeCompare(b.name);
      });
      if (!ascending) sortedPokemonData.reverse();
      updateList(sortedPokemonData);
    }

    // List has to update visually so, re-render it is
    function updateList(pokemonData) {
      $(".data-row").remove();
      pokemonData.forEach(element => {
        $("#pokemonTable").append(newRow(element.name, element.url));
      });
    }

    // Table is already made when this function is called
    // so its safe to use it here
    function newRow(pokemonName, pokemonLink) {
      let row = $('<tr class="data-row"></tr>');
      let nameData = $("<td></td>").text(pokemonName);
      let apiLinkData = $(`<td></td>`).html(`<a href="${pokemonLink}">Avaa</a>`);
      return row.append(nameData, apiLinkData);
    }
    // üîπ Teht√§v√§: Kirjoita t√§h√§n jQuery-koodi, joka tekee seuraavat asiat:

    // 1Ô∏è‚É£ Kun "Lataa Pok√©monit" -painiketta painetaan:
    //    - N√§yt√§ k√§ytt√§j√§lle teksti "Ladataan dataa..."
    //    - Tee AJAX GET -pyynt√∂ osoitteeseen:
    //         https://pokeapi.co/api/v2/pokemon?limit=10
    //
    //    API palauttaa JSON-olion, jonka rakenne on seuraava:
    //    {
    //       "count": 1302,
    //       "results": [
    //          { "name": "bulbasaur", "url": "https://pokeapi.co/api/v2/pokemon/1/" },
    //          { "name": "ivysaur",   "url": "https://pokeapi.co/api/v2/pokemon/2/" },
    //          ...
    //       ]
    //    }
    //
    //    -> T√§st√§ datasta meit√§ kiinnostaa siis vain "results"-kentt√§:
    //       data.results
    //
    //    - Tallenna results-taulukko omaan muuttujaan (esim. pokemonData)
    //    - Kutsu funktiota, joka n√§ytt√§√§ tuloksen taulukkona

    // 2Ô∏è‚É£ Luo funktio (esim. tulostaTaulukko), joka rakentaa taulukon:
    //    Sarakkeet: "Nimi" ja "API-linkki"
    //    (API:n palauttamassa datassa on kent√§t "name" ja "url")

    // 3Ô∏è‚É£ Lis√§√§ taulukon otsikkoon "Nimi" klikkaustoiminto:
    //    Kun k√§ytt√§j√§ painaa otsikkoa, taulukon rivit
    //    lajitellaan nimen perusteella aakkosj√§rjestykseen.
    //
    //    Voit k√§ytt√§√§ metodia:
    //        array.sort(function(a, b) {
    //          return a.name.localeCompare(b.name);
    //        });
    //
    //    Muista p√§ivitt√§√§ taulukko lajittelun j√§lkeen.

    // üí° Vinkkej√§:
    // - K√§yt√§ $('#load-data').on('click', ...) painikkeen k√§sittelyyn
    // - K√§yt√§ $('#result').html(...) tulostamiseen
    // - AJAX-pyynn√∂n voi tehd√§ $.get()-funktiolla
    // - Datan tulostamisessa voit hy√∂dynt√§√§ forEach- tai map-funktiota
  </script>

</body>
</html>
